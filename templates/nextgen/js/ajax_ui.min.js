var __awaiter=this&&this.__awaiter||function(r,n,s,l){return new(s||(s=Promise))(function(e,t){function a(e){try{i(l.next(e))}catch(e){t(e)}}function o(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(a,o)}i((l=l.apply(r,n||[])).next())})},__generator=this&&this.__generator||function(a,o){var i,r,n,e,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(n=n.call(r,t[1])).done)return n;switch(r=0,n&&(t=[0,n.value]),t[0]){case 0:case 1:n=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(n=0<(n=s.trys).length&&n[n.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!n||t[1]>n[0]&&t[1]<n[3])){s.label=t[1];break}if(6===t[0]&&s.label<n[1]){s.label=n[1],n=t;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(t);break}n[2]&&s.ops.pop(),s.trys.pop();continue}t=o.call(a,s)}catch(e){t=[6,e],r=0}finally{i=n=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},BASE="",AjaxUI=function(){function o(){(this._this=this).ajax_complete_listeners=[],this.start_listeners=[],this.trees_filled=!1,this.xhrPool=[],window.onpopstate=this.onPopState,$(document).ajaxError(this.onAjaxError.bind(this)),$(document).ajaxComplete(this.onAjaxComplete.bind(this))}return o.getInstance=function(){return null!=o.singleton&&null!=o.singleton||(o.singleton=new o),o.singleton},o.prototype.start=function(){window.location.pathname;BASE=getBasePath();var t=this;$.ajaxSetup({beforeSend:function(e){t.xhrPool.push(e)}}),this.checkRedirect(),this.tree_fill(),this.registerForm(),this.registerLinks(),this.getTypeaheadData();for(var e=0,a=this.start_listeners;e<a.length;e++){(0,a[e])()}},o.prototype.checkRedirect=function(){if(null!=$("input#redirect_url").val()){var e=$("input#redirect_url").val().toString();""!=e&&openLink(e)}},o.prototype.addAjaxCompleteAction=function(e){this.ajax_complete_listeners.push(e)},o.prototype.addStartAction=function(e){this.start_listeners.push(e)},o.prototype.registerForm=function(){"use strict";var e={success:this.showFormResponse,beforeSubmit:this.showRequest,beforeSerialize:this.form_beforeSerialize};$("form").not(".no-ajax").ajaxForm(e)},o.prototype.showFormResponse=function(e,t,a,o){"use strict";$("#content").html($(e).find("#content-data").html()).fadeIn("slow")},o.prototype.form_beforeSerialize=function(o,e){return o.find("input[type=checkbox].tristate").each(function(e){var t=$(this).attr("name"),a=$(this).val();o.append('<input type="hidden" name="'+t+'" value="'+a+'">')}),o.find("input[type=checkbox].tristate").remove(),!0},o.prototype.showRequest=function(e,t,a){"use strict";return $(t).hasClass("no-progbar")||($("#content").hide(0),o.getInstance().beforeAjaxSubmit(),$("#progressbar").show(0)),!0},o.prototype.registerSubmitBtn=function(){var e=this;$("button.submit").unbind("click").click(function(){e.submitFormSubmitBtn($(this).closest("form"),this)})},o.prototype.submitForm=function(e){"use strict";var t={success:this.showFormResponse,beforeSubmit:this.showRequest};$(e).ajaxSubmit(t)},o.prototype.submitFormSubmitBtn=function(e,t){var a=$(t).attr("name"),o=$(t).attr("value");void 0===o&&(o=""),$(e).append('<input type="hidden" name="'+a+'" value="'+o+'">'),this.submitForm(e)},o.prototype.registerLinks=function(){"use strict";var o=this;$("a").not(".link-anchor").not(".link-collapse").not(".link-external").not(".tree-btns").not(".back-to-top").not(".link-datasheet").unbind("click").click(function(e){e.preventDefault();var t=$(this);if(null!=t.attr("href")){var a=addURLparam(t.attr("href"),"ajax");return o.abortAllAjax(),o.beforeAjaxSubmit(),$("#content").hide(0).load(a+" #content-data"),$("#progressbar").show(0),!0}}),$("a.link-anchor").unbind("click").click(function(e){e.preventDefault(),scrollToAnchor($(this).prop("hash"))})},o.prototype.onNodeSelected=function(e,t){"use strict";-1!==t.href.indexOf("github.com")||-1!==t.href.indexOf("phpdoc")?(openInNewTab(t.href),$(this).treeview("toggleNodeSelected",t.nodeId)):(o.getInstance().abortAllAjax(),$("#content").hide().load(addURLparam(t.href,"ajax")+" #content-data"),$("#progressbar").show()),$(this).treeview("toggleNodeExpanded",t.nodeId),$("#sidebar-container").removeClass("show")},o.prototype.onNodeContextmenu=function(e,t){"use strict";""!==t.href&&openInNewTab(t.href)},o.prototype.tree_fill=function(){"use strict";var e=Cookies.get("tree_datasource_tree-categories"),t=Cookies.get("tree_datasource_tree-devices"),a=Cookies.get("tree_datasource_tree-tools");void 0===e&&(e="categories"),void 0===t&&(t="devices"),void 0===a&&(a="tools"),this.treeLoadDataSource("tree-categories",e),this.treeLoadDataSource("tree-devices",t),this.treeLoadDataSource("tree-tools",a),this.trees_filled=!0},o.prototype.initTree=function(t,e){var a=this.onNodeSelected,o=this.onNodeContextmenu;$.getJSON(BASE+e,function(e){$(t).treeview({data:e,enableLinks:!1,showIcon:!1,showBorder:!0,onNodeSelected:a,onNodeContextmenu:o,expandIcon:"fas fa-plus fa-fw fa-treeview",collapseIcon:"fas fa-minus fa-fw fa-treeview"}).treeview("collapseAll",{silent:!0})})},o.prototype.treeLoadDataSource=function(e,t){var a=$(".tree-btns[data-mode='"+t+"']").html();switch(a+=" \n<span class='caret'></span>",t){case"categories":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/categories"),$("#"+e+"-title").html(a);break;case"locations":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/locations"),$("#"+e+"-title").html(a);break;case"footprints":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/footprints"),$("#"+e+"-title").html(a);break;case"manufacturers":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/manufacturers"),$("#"+e+"-title").html(a);break;case"suppliers":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/suppliers"),$("#"+e+"-title").html(a);break;case"tools":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/tools"),$("#"+e+"-title").html(a);break;case"devices":ajaxui.initTree("#"+e,"api.php/1.0.0/tree/devices"),$("#"+e+"-title").html(a)}},o.prototype.updateTrees=function(){this.tree_fill()},o.prototype.getTypeaheadData=function(){var t=this;$.getJSON("api.php/1.0.0/3d_models/files",function(e){t.model_list=e,t.fillTypeahead()}),$.getJSON("api.php/1.0.0/img_files/files",function(e){t.img_list=e,t.fillTypeahead()})},o.prototype.fillTypeahead=function(){$("#models-search").length&&!$("#models-search").hasClass("initialized")&&($("#models-search").addClass("initialized"),$("#models-search").typeahead({source:this.model_list})),$("#img-search").length&&!$("#img-search").hasClass("initialized")&&($("#img-search").addClass("initialized"),$("#img-search").typeahead({source:this.img_list}))},o.prototype.abortAllAjax=function(){var a=this;$(this.xhrPool).each(function(e,t){t.abort(),a.xhrPool.splice(e,1)})},o.prototype.beforeAjaxSubmit=function(){},o.prototype.onAjaxError=function(e,t,a){"use strict";"abort"!=t.statusText&&(console.log(e),500==t.status&&""!==t.responseText&&console.log("Response:"+t.responseText))},o.prototype.onPopState=function(e){var t=location.href;-1!==t.indexOf(".php")&&-1===t.indexOf("index.php")&&($("#content").hide(0).load(addURLparam(location.href,"ajax")+" #content-data"),$("#progressbar").show(0))},o.prototype.onAjaxComplete=function(e,t,a){var o=this.xhrPool.indexOf(t);-1<o&&this.xhrPool.splice(o,1);var i=a.url;if(-1==i.indexOf("api.php")){if($("#progressbar").hide(0),$("#content").fadeIn("fast"),this.registerForm(),this.registerLinks(),this.registerSubmitBtn(),this.fillTypeahead(),-1!=i.indexOf("#")){var r=i.substring(i.indexOf("#"));scrollToAnchor(r)}if(-1==i.indexOf("api.php/1.0.0/3d_models")){this.checkRedirect();for(var n=0,s=this.ajax_complete_listeners;n<s.length;n++){(0,s[n])()}if("post"!==a.type.toLowerCase()&&"json"!==a.dataType&&"jsonp"!==a.dataType){window.history.pushState(null,"",removeURLparam(a.url,"ajax")),$("#login-link").attr("href","login.php?redirect="+encodeURIComponent(i));var l=t.responseText,c=extractTitle(l);if(""!==c&&(document.title=c),this.trees_filled){var d=$("#tree-categories").treeview("getSelected")[0];void 0!==d&&-1==a.url.indexOf(d.href)&&$("#tree-categories").treeview("unselectNode",[d.nodeId,{silent:!0}]),void 0!==(d=$("#tree-devices").treeview("getSelected")[0])&&-1==a.url.indexOf(d.href)&&$("#tree-devices").treeview("unselectNode",[d.nodeId,{silent:!0}]),void 0!==(d=$("#tree-tools").treeview("getSelected")[0])&&-1==a.url.indexOf(d.href)&&$("#tree-tools").treeview("unselectNode",[d.nodeId,{silent:!0}])}}}}},o}(),ajaxui=AjaxUI.getInstance();function setBootstrapSelectStyle(){$.fn.selectpicker.Constructor.DEFAULTS.style="bg-white border"}function makeCharts(){$(".chart").each(function(e,t){var a=$(t).data("data"),o=$(t).data("type"),i=t.getContext("2d");new Chart(i,{type:o,data:a,options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})})}function makeGreekInput(){$("input[type=text], textarea, input[type=search]").unbind("keydown").keydown(function(e){var t="";if(e.altKey){switch(e.key){case"w":t="Ω";break;case"u":case"m":t="µ";break;case"p":t="φ";break;case"a":t="α";break;case"b":t="β";break;case"c":t="γ";break;case"d":t="δ";break;case"l":t="£";break;case"y":t="¥";break;case"o":t="¤";break;case"1":t="∑";break;case"2":t="∫";break;case"3":t="≤";break;case"4":t="≥";break;case"5":t="π";break;case"q":t="©";break;case"e":t="€"}if(""==t)return;var a=$(this),o=a[0].selectionStart,i=a.val();a.val(i.substring(0,o)+t+i.substring(o))}}),this.greek_once=!0}function makeTypeAhead(){$("#models-search").length&&!$("#models-search").hasClass("initialized")&&($("#models-search").addClass("initialized"),$.getJSON("api.php/1.0.0/3d_models/files",function(e){$("#models-search").typeahead({source:e})}))}function makeTriStateCheckbox(){$(".tristate").tristate({checked:"true",unchecked:"false",indeterminate:"indeterminate"})}function registerHoverImages(){"use strict";$("img[rel=popover]").popover({html:!0,trigger:"hover",placement:"auto",container:"body",content:function(){return'<img class="img-fluid" src="'+this.src+'" />'}})}function makeSortTable(){"use strict";$($.fn.dataTable.tables()).DataTable().fixedHeader.adjust(),$(".export-helper").each(function(e){var t=$(this).siblings("input");$(this).text(t.val().toString())}),$.extend(!0,$.fn.DataTable.Buttons.defaults,{dom:{container:{className:"dt-buttons btn-group float-right"},button:{className:"btn btn-light btn-xs border"},collection:{tag:"ul",className:"dt-button-collection dropdown-menu",button:{tag:"li",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"a",className:""}}}});var e=function(){return"Generated by Part-DB on "+(new Date).toLocaleString()},t=function(){return $("#export-title").length?$("#export-title").text():"*"},a=function(){return $("#export-messageTop").length?$("#export-messageTop").text():"*"};if(!$.fn.DataTable.isDataTable(".table-sortable")){var p=$(".table-sortable").DataTable({paging:!1,ordering:!0,info:!1,fixedHeader:{header:768<=$(window).width(),headerOffset:$("#navbar").height()},searching:!1,select:!!$(".table-sortable").hasClass("table-selectable")&&{style:"os",selector:"td:not(.no-select)"},order:[],buttons:$(".table-sortable").hasClass("table-export")?[{extend:"copyHtml5",text:'<i class="fas fa-copy fa-fw"></i>',titleAttr:"Copy",exportOptions:{columns:":not(.no-export)"}},{extend:"excelHtml5",text:'<i class="fas fa-file-excel fa-fw"></i>',titleAttr:"Excel",exportOptions:{columns:":not(.no-export)"},messageBottom:e,messageTop:a,title:t},{extend:"csvHtml5",text:'<i class="fas fa-file-alt fa-fw"></i>',titleAttr:"CSV",exportOptions:{columns:":not(.no-export)"}},{extend:"pdfHtml5",text:'<i class="fas fa-file-pdf fa-fw"></i>',titleAttr:"PDF",exportOptions:{columns:":not(.no-export)"},messageBottom:e,messageTop:a,title:t},{extend:"print",text:'<i class="fas fa-print fa-fw"></i>',titleAttr:"Print",exportOptions:{columns:":not(.no-export)"},messageBottom:e,messageTop:a,title:t}]:null,columnDefs:[{targets:[1],type:"natural-nohtml"},{targets:"no-sort",orderable:!1}]});1==$("#auto_sort").val()&&p.columns(".order-default").order("asc").draw(),p.on("select deselect",function(e,t,a,o){var i=p.rows({selected:!0}),r=i.count(),n=[];if(0<r){$(".select_actions").show(),$(".selected_n").text(r);for(var s=0,l=i[0];s<l.length;s++){var c=l[s];n.push($(i.row(c).node()).find("input").val())}}else $(".select_actions").hide();var d=n.join();$("input[name='selected_ids']").val(d)});for(var o=0;o<p.context.length;o++){var i=$(p.table(o).container()).closest(".card").find(".card-header");p.table(o).buttons().container().appendTo(i)}}}function makeFileInput(){"use strict";$(".file").fileinput()}function registerJumpToTop(){$(window).scroll(function(){50<$(this).scrollTop()?$("#back-to-top").fadeIn():$("#back-to-top").fadeOut()}),$("#back-to-top").click(function(){return $("#back-to-top").tooltip("hide"),$("body,html").animate({scrollTop:0},800),!1}).tooltip()}function rightClickSubmit(){var a=AjaxUI.getInstance();$("button.rightclick").off("contextmenu").contextmenu(function(e){e.preventDefault();var t=$(this).closest("form");return t.append('<input type="hidden" name="rightclicked" value="true">'),a.submitFormSubmitBtn(t,this),!1})}function treeviewBtnInit(){$(".tree-btns").click(function(e){e.preventDefault(),$(this).parents("div.dropdown").removeClass("show"),$(".dropdown-menu.show").removeClass("show");var t=$(this).data("mode"),a=$(this).data("target");$(this).text();return"collapse"===t?$("#"+a).treeview("collapseAll",{silent:!0}):"expand"===t?$("#"+a).treeview("expandAll",{silent:!0}):(Cookies.set("tree_datasource_"+a,t),ajaxui.treeLoadDataSource(a,t)),!1})}function registerX3DOM(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){if($("x3d").length)try{x3dom.reload()}catch(e){}return[2]})})}function registerBootstrapSelect(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return $(".selectpicker").selectpicker(),[2]})})}function addCollapsedClass(){$("div.collapse.card-collapse").siblings("div.card-header").children('a[data-toggle="collapse"]').addClass("collapsed")}function fixCurrencyEdits(){$("input[type=number]").each(function(e,t){var a=$(t);if(""==a.val()&&-1!==a.prop("defaultValue").indexOf(",")){var o=a.prop("defaultValue").replace(",",".");a.val(o)}})}function registerAutoRefresh(){var e=$("#autorefresh").val();0<e&&window.setTimeout(reloadPage,e)}function fixSelectPaginationHeight(){$(".pagination>li>select").css("height",parseInt($(".pagination").css("height"))-2)}function livesearch(e,t,a){if("Enter"!=e.key){var o=$(t),i=o.val(),r=o.closest("form");r.addClass("no-progbar");var n=r.data("jqxhr");void 0!==n&&n.abort(),i.length>=a?submitForm(r):"Backspace"==e.key&&openLink(BASE+"show_search_parts.php?hint"),r.removeClass("no-progbar")}}function makeHighlight(){var e=$("#highlight").val();void 0!==e&&""!=e&&$("table").highlight(e,{element:"span"})}function makeTooltips(){$("body").tooltip("dispose"),$("body").tooltip({selector:"[title]",container:"body"})}function viewer3d_models(){if($("#models-picker").length){var a="";$("#models-picker").change(o),$.getJSON("api.php/1.0.0/3d_models/dir_tree",function(e){$("#tree-footprint").treeview({data:e,enableLinks:!1,showIcon:!1,showBorder:!0,onNodeSelected:t}).treeview("collapseAll",{silent:!0})}),$("#models-search-go").click(function(){var e="models/"+$("#models-search").val();$("#foot3d-model").attr("url",e),$("#foot3d-model2").attr("url",e),$("#path").text(e)})}function o(){var e=$("#models-picker").val();if(""!=a){var t="models/"+a+"/"+e;$("#foot3d-model").attr("url",t),$("#foot3d-model2").attr("url",t),$("#path").text(t)}}function t(e,t){a=t.href,$.getJSON("api.php/1.0.0/3d_models/files/"+a,function(e){$("#models-picker").empty(),e.forEach(function(e){$("<option><option/>").val(e).text(e).appendTo("#models-picker"),$("#models-picker").selectpicker("refresh"),o()})})}}$(function(e){ajaxui.addStartAction(addCollapsedClass),ajaxui.addStartAction(fixSelectPaginationHeight),ajaxui.addStartAction(treeviewBtnInit),ajaxui.addStartAction(registerJumpToTop),ajaxui.addStartAction(makeTooltips),ajaxui.addStartAction(fixCurrencyEdits),ajaxui.addStartAction(registerAutoRefresh),ajaxui.addStartAction(scrollUpForMsg),ajaxui.addStartAction(makeSortTable),ajaxui.addStartAction(rightClickSubmit),ajaxui.addStartAction(makeTriStateCheckbox),ajaxui.addStartAction(makeHighlight),ajaxui.addStartAction(viewer3d_models),ajaxui.addStartAction(makeGreekInput),ajaxui.addStartAction(makeCharts),ajaxui.addStartAction(setBootstrapSelectStyle),ajaxui.addAjaxCompleteAction(addCollapsedClass),ajaxui.addAjaxCompleteAction(fixSelectPaginationHeight),ajaxui.addAjaxCompleteAction(registerHoverImages),ajaxui.addAjaxCompleteAction(makeSortTable),ajaxui.addAjaxCompleteAction(makeFileInput),ajaxui.addAjaxCompleteAction(makeTooltips),ajaxui.addAjaxCompleteAction(registerX3DOM),ajaxui.addAjaxCompleteAction(registerBootstrapSelect),ajaxui.addAjaxCompleteAction(fixCurrencyEdits),ajaxui.addAjaxCompleteAction(registerAutoRefresh),ajaxui.addAjaxCompleteAction(scrollUpForMsg),ajaxui.addAjaxCompleteAction(rightClickSubmit),ajaxui.addAjaxCompleteAction(makeTriStateCheckbox),ajaxui.addAjaxCompleteAction(makeHighlight),ajaxui.addAjaxCompleteAction(viewer3d_models),ajaxui.addAjaxCompleteAction(makeGreekInput),ajaxui.addAjaxCompleteAction(makeCharts),ajaxui.start()}),$("#search-submit").click(function(e){$("#searchbar").removeClass("show")}),$(window).resize(function(){var e=$("#navbar").height()+10;$("body").css("padding-top",e),$("#fixed-sidebar").css("top",e)}),$(window).on("load",function(){var e=$("#navbar").height()+10;$("body").css("padding-top",e),$("#fixed-sidebar").css("top",e)});